{% extends "base.html" %}

{% block title %}Your Cart | Computer Aid MW{% endblock %}

{% block content %}
<div class="container mt-5 mb-5">

    <h2 class="mb-4">
        <i class="fas fa-shopping-cart me-2"></i>Your Cart
    </h2>

    {% if cart and cart|length > 0 %}

        <div class="table-responsive">
            <table class="table align-middle">
                <thead>
                    <tr>
                        <th>Product</th>
                        <th class="text-end">Price</th>
                        <th class="text-end">Action</th>
                    </tr>
                </thead>
                <tbody>

                    {% for product_id, item in cart.items() %}
                    <tr>
                        <td>
                            <div class="d-flex align-items-center">
                                <img
                                    src="{{ item.image }}"
                                    alt="{{ item.name }}"
                                    width="70"
                                    height="70"
                                    class="me-3 rounded"
                                    style="object-fit: cover;"
                                >
                                <strong>{{ item.name }}</strong>
                            </div>
                        </td>

                        <td class="text-end">
                            MWK {{ "{:,.0f}".format(item.price) }}
                        </td>

                        <td class="text-end">
                            <!-- âŒ REMOVE FROM CART -->
                            <form method="POST"
                                  action="{{ url_for('remove_from_cart', product_id=product_id) }}">
                                <button type="submit"
                                        class="btn btn-sm btn-outline-danger">
                                    <i class="fas fa-trash me-1"></i>
                                    Remove
                                </button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}

                </tbody>
            </table>
        </div>

        <div class="d-flex justify-content-between align-items-center mt-4 flex-wrap gap-3">
            <h4 class="mb-0">
                Total:
                <strong>MWK {{ "{:,.0f}".format(total) }}</strong>
            </h4>

            <a href="{{ url_for('checkout') }}"
               class="btn btn-success btn-lg">
                <i class="fab fa-whatsapp me-2"></i>
                Checkout via WhatsApp
            </a>
        </div>

    {% else %}

        <div class="alert alert-info">
            Your cart is currently empty.
        </div>

        <a href="{{ url_for('home') }}" class="btn btn-primary">
            <i class="fas fa-arrow-left me-2"></i>
            Continue Shopping
        </a>

    {% endif %}

</div>
{% endblock %}
